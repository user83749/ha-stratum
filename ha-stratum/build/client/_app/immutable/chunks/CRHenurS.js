import{K as p,L as h,M as m,N as d,O as _,j as v,i as g,z as y,P as k,Q as M,R as b,S as w,T as S,e as D,U as N,g as U,V as x,W as A}from"./BFobMjM6.js";class F{anchor;#s=new Map;#t=new Map;#e=new Map;#i=new Set;#r=!0;constructor(s,t=!0){this.anchor=s,this.#r=t}#n=s=>{if(this.#s.has(s)){var t=this.#s.get(s),e=this.#t.get(t);if(e)p(e),this.#i.delete(t);else{var n=this.#e.get(t);n&&(this.#t.set(t,n.effect),this.#e.delete(t),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),e=n.effect)}for(const[i,a]of this.#s){if(this.#s.delete(i),i===s)break;const f=this.#e.get(a);f&&(h(f.effect),this.#e.delete(a))}for(const[i,a]of this.#t){if(i===t||this.#i.has(i))continue;const f=()=>{if(Array.from(this.#s.values()).includes(i)){var u=document.createDocumentFragment();k(a,u),u.append(d()),this.#e.set(i,{effect:a,fragment:u})}else h(a);this.#i.delete(i),this.#t.delete(i)};this.#r||!e?(this.#i.add(i),m(a,f,!1)):f()}}};#a=s=>{this.#s.delete(s);const t=Array.from(this.#s.values());for(const[e,n]of this.#e)t.includes(e)||(h(n.effect),this.#e.delete(e))};ensure(s,t){var e=v,n=M();if(t&&!this.#t.has(s)&&!this.#e.has(s))if(n){var i=document.createDocumentFragment(),a=d();i.append(a),this.#e.set(s,{effect:_(()=>t(a)),fragment:i})}else this.#t.set(s,_(()=>t(this.anchor)));if(this.#s.set(e,s),n){for(const[f,c]of this.#t)f===s?e.unskip_effect(c):e.skip_effect(c);for(const[f,c]of this.#e)f===s?e.unskip_effect(c.effect):e.skip_effect(c.effect);e.oncommit(this.#n),e.ondiscard(this.#a)}else g&&(this.anchor=y),this.#n(e)}}let o=!1,l=Symbol();function O(r,s,t){const e=t[s]??={store:null,source:w(void 0),unsubscribe:b};if(e.store!==r&&!(l in t))if(e.unsubscribe(),e.store=r??null,r==null)e.source.v=void 0,e.unsubscribe=b;else{var n=!0;e.unsubscribe=S(r,i=>{n?e.source.v=i:D(e.source,i)}),n=!1}return r&&l in t?N(r):U(e.source)}function T(){const r={};function s(){x(()=>{for(var t in r)r[t].unsubscribe();A(r,l,{enumerable:!1,value:!0})})}return[r,s]}function j(r){var s=o;try{return o=!1,[r(),o]}finally{o=s}}export{F as B,T as a,j as c,O as s};
