{"version":3,"file":"_server.ts-BCAKsdR0.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/config/_server.ts.js"],"sourcesContent":["import { json, error } from \"@sveltejs/kit\";\nimport { existsSync, writeFileSync, readFileSync, mkdirSync } from \"fs\";\nimport { join } from \"path\";\nimport { d as defaultConfig, m as migrateConfig } from \"../../../../chunks/dashboard.js\";\nconst DATA_DIR = process.env.ADDON === \"true\" ? \"/data\" : join(process.cwd(), \"data\");\nconst CONFIG_PATH = join(DATA_DIR, \"dashboard.json\");\nfunction ensureDir() {\n  if (!existsSync(DATA_DIR)) mkdirSync(DATA_DIR, { recursive: true });\n}\nconst GET = () => {\n  ensureDir();\n  if (!existsSync(CONFIG_PATH)) {\n    const fresh = defaultConfig();\n    writeFileSync(CONFIG_PATH, JSON.stringify(fresh, null, 2), \"utf-8\");\n    return json(fresh);\n  }\n  try {\n    const raw = JSON.parse(readFileSync(CONFIG_PATH, \"utf-8\"));\n    return json(migrateConfig(raw));\n  } catch {\n    error(500, \"Failed to read dashboard config\");\n  }\n};\nconst POST = async ({ request }) => {\n  ensureDir();\n  let body;\n  try {\n    body = await request.json();\n  } catch {\n    error(400, \"Invalid JSON body\");\n  }\n  try {\n    const config = migrateConfig(body);\n    writeFileSync(CONFIG_PATH, JSON.stringify(config, null, 2), \"utf-8\");\n    return json({ ok: true });\n  } catch {\n    error(500, \"Failed to write dashboard config\");\n  }\n};\nexport {\n  GET,\n  POST\n};\n"],"names":[],"mappings":";;;;;AAIA,MAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,KAAK,KAAK,MAAM,GAAG,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,MAAM,CAAC;AACrF,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,EAAE,gBAAgB,CAAC;AACpD,SAAS,SAAS,GAAG;AACrB,EAAE,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE,SAAS,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;AACrE;AACK,MAAC,GAAG,GAAG,MAAM;AAClB,EAAE,SAAS,EAAE;AACb,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,EAAE;AAChC,IAAI,MAAM,KAAK,GAAG,aAAa,EAAE;AACjC,IAAI,aAAa,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC;AACvE,IAAI,OAAO,IAAI,CAAC,KAAK,CAAC;AACtB,EAAE;AACF,EAAE,IAAI;AACN,IAAI,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;AAC9D,IAAI,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;AACnC,EAAE,CAAC,CAAC,MAAM;AACV,IAAI,KAAK,CAAC,GAAG,EAAE,iCAAiC,CAAC;AACjD,EAAE;AACF;AACK,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK;AACpC,EAAE,SAAS,EAAE;AACb,EAAE,IAAI,IAAI;AACV,EAAE,IAAI;AACN,IAAI,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE;AAC/B,EAAE,CAAC,CAAC,MAAM;AACV,IAAI,KAAK,CAAC,GAAG,EAAE,mBAAmB,CAAC;AACnC,EAAE;AACF,EAAE,IAAI;AACN,IAAI,MAAM,MAAM,GAAG,aAAa,CAAC,IAAI,CAAC;AACtC,IAAI,aAAa,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC;AACxE,IAAI,OAAO,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,CAAC;AAC7B,EAAE,CAAC,CAAC,MAAM;AACV,IAAI,KAAK,CAAC,GAAG,EAAE,kCAAkC,CAAC;AAClD,EAAE;AACF;;;;"}